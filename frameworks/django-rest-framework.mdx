---
title: "Django REST Framework"
description: "A powerful and flexible toolkit for building Web APIs."
---

<Tip>
  If you're starting a new project, you might want to consider using [Django
  Ninja](https://django-ninja.rest-framework.com/) instead.
</Tip>

## Add middleware

To get started, create a new app in Apitally and select Django REST Framework as your framework.

Install the [Apitally Python client](https://pypi.org/project/apitally/) in your Django project (e.g. using `pip` or `poetry`) with the `django_rest_framework` extra.

<CodeGroup>
```shell pip
pip install apitally[django_rest_framework]
```

```toml poetry (pyproject.toml)
[tool.poetry.dependencies]
apitally = { version = "*", extras = ["django_rest_framework"] }
```

</CodeGroup>

<Snippet file="configure-django-middleware.mdx" />

```python
MIDDLEWARE = [
    # Other middlewares first ...
    "apitally.django_rest_framework.ApitallyMiddleware",
]
APITALLY_MIDDLEWARE = {
    "client_id": "your-client-id",
    "env": "your-env-name",
}
```

## Configure API key auth

Enable the synchronization of API key hashes from Apitally to your application by setting `enable_keys` to `True` in the middleware settings.

```python
APITALLY_MIDDLEWARE = {
    "client_id": "your-client-id",
    "env": "your-env-name",
    "enable_keys": True,  # <--
}
```

<div className="-mt-4">
  <Snippet file="api-key-sync-info.mdx" />
</div>

To secure your API views with API key authentication use the `HasAPIKey` permission class or
the `HasAPIKeyWithScopes` permission class factory, if you need to specify required scopes.

You can access information about the API key in your endpoint function via the `request.auth` object.
This can be useful if you need to check scopes dynamically, for example.

<CodeGroup>

```python Class-based view
from rest_framework.views import APIView
from rest_framework.request import Request
from rest_framework.response import Response
from apitally.django_rest_framework import HasAPIKey

class ListItemsView(APIView):
    permission_classes = [HasAPIKey]

    def get(self, request: Request) -> Response:
        return Response(["item1"])
```

```python Class-based view with scopes
from rest_framework.views import APIView
from rest_framework.request import Request
from rest_framework.response import Response
from apitally.django_rest_framework import HasAPIKeyWithScopes

class ListItemsView(APIView):
    permission_classes = [HasAPIKeyWithScopes(["read:items"])]

    def get(self, request: Request) -> Response:
        return Response(["item1"])
```

```python Function-based view
from rest_framework.decorators import api_view, permission_classes
from rest_framework.request import Request
from rest_framework.response import Response
from apitally.django_rest_framework import HasAPIKeyWithScopes

@api_view()
@permission_classes([HasAPIKeyWithScopes(["read:items"])])
def list_items(self, request: Request) -> Response:
    return Response(["item1"])
```

```python Access key info
from rest_framework.decorators import api_view, permission_classes
from rest_framework.request import Request
from rest_framework.response import Response
from apitally.django_rest_framework import HasAPIKey

@api_view()
@permission_classes([HasAPIKey])
def list_items(self, request: Request) -> Response:
    assert request.auth.check_scopes(["read:items"])
    print("Key name:", request.auth.name)
    print("Key scopes:", request.auth.scopes)
    return Response(["item1"])
```

</CodeGroup>

### Custom header

While it is recommended to use the standard `Authorization` header for API key authentication,
you can configure your application to accept a custom header instead.
Simply set `APITALLY_CUSTOM_API_KEY_HEADER` in your Django settings file.

```python
APITALLY_CUSTOM_API_KEY_HEADER = "ApiKey"
```

<Snippet file="use-api-keys.mdx" />
